"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.PubKeyInfo = exports.stripCertHeaderAndFooter = void 0;
const stripCertHeaderAndFooter = (cert) => {
    cert = cert.replace(/-+BEGIN CERTIFICATE-+\r?\n?/, '');
    cert = cert.replace(/-+END CERTIFICATE-+\r?\n?/, '');
    cert = cert.replace(/\r\n/g, '\n');
    return cert.trimEnd();
};
exports.stripCertHeaderAndFooter = stripCertHeaderAndFooter;
function PubKeyInfo(pubKey) {
    const pubKeyTrimmed = stripCertHeaderAndFooter(pubKey);
    return function ({ prefix }) {
        prefix = prefix || '';
        prefix = prefix ? prefix + ':' : prefix;
        return `<${prefix}X509Data><${prefix}X509Certificate>${pubKeyTrimmed}</${prefix}X509Certificate</${prefix}X509Data>`;
    };
}
exports.PubKeyInfo = PubKeyInfo;
